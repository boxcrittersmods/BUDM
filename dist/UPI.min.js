const uWindow="undefined"!=typeof unsafeWindow?unsafeWindow:window;let UPI;!function(){"use strict";let o={uWindow:uWindow,UPI:UPI};if(window.UPI){for(let e in o)delete window[e];throw"UPI variables are global! please scope/sandbox it"}class e extends EventHandler{constructor({parent:o,GM_info:t,scriptSource:i}){if(this.modInfo={},this.parent&&(this.parent=o),this.modInfo.scriptSource=i,t){if("object"!=typeof t)throw new TypeError("Invalid GM_info!");if(!t)throw new TypeError("Invalid GM_info!");this.modInfo.GM_info=t,this.modInfo.scriptSource||(this.modInfo.scriptSource=t.scriptSource),this.modInfo.name||(this.modInfo.name=this.modInfo.GM_info.script.name),this.modInfo.version||(this.modInfo.version=this.modInfo.GM_info.script.name)}if(!i)throw"No Script Source!";if(this.modInfo.header=e.parseScriptHeader(this.modInfo.scriptSource),this.modInfo.name=this.modInfo.header.name,!this.modInfo.name)throw"No module name!";this.modInfo.author=this.modInfo.header.author,this.modInfo.version=this.modInfo.header.version,this.modInfo.id=this.modInfo.header.UPI.id||e.camelize(this.modInfo.name),this.modInfo.abbrev=this.modInfo.header.UPI.abbrev||this.modInfo.name.split(" ").map((o=>o[0].toUpperCase())).join(""),this.modInfo.header.UPI.require&&(this.modInfo.require=this.modInfo.header.UPI.require.split(/\s*,\s*/)),this.parent?(this.parent[this.modInfo.id]=this,this.modInfo.idList=this.parent.abbrevList.concat([this.modInfo.id]),this.modInfo.abbrevList=this.parent.abbrevList.concat([this.modInfo.abbrev])):(this.modInfo.idList=[this.modInfo.id],this.modInfo.abbrevList=[this.modInfo.abbrev]),this.info(`${this.modInfo.name} by ${this.modinfo.author}`)}static camelize(o){return o.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,(function(o,e){return 0==+o?"":0===e?o.toLowerCase():o.toUpperCase()}))}static parseScriptHeader(o){let e=o.match(/(?:\/\/\s*)?==UserScript==([\S\s]*)==\/UserScript==/)[1].split(/\n\s*\/\//g).map((o=>o.trim())).filter((o=>o)).map((o=>{let e=o.match(/\s+/);return[o.slice(0,e.index).split("."),o.slice(e.index+e[0].length)]}));mod.debug("header arrayForm:",e);let t={};for(let[o,i]of e){let e=o.pop(),n=t;for(let e of o){if(e in n&&"object"!=typeof n[e])throw`Path ${o.join(".")} has existing value at ${e}`;n=n[e]}if(e in n)throw`Value ${o.join(".")}.${key} already exists`;n[e]=i}return mod.debug("header objForm:",t)}}["debug","log","info","warn","error"].forEach((o=>e.prototype[o]=function(...e){return console[o](`[${this.abbrevList.join(".")}]`,...e),e[0]})),UPI=new e({name:"United Program Interface",author:"SArpnt and TumbleGamer",id:"UPI",abbrev:"UPI"}),UPI.info(UPI)}();