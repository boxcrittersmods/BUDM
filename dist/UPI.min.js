const uWindow="undefined"!=typeof unsafeWindow?unsafeWindow:window;let UPI;!function(){"use strict";let t={uWindow:uWindow,UPI:UPI};if(window.UPI){for(let e in t)delete window[e];throw"UPI variables are global! please scope/sandbox it"}class e{constructor(t,e=!!t){if(!Array.isArray(t)&&void 0!==t)throw new TypeError("Paramater 1 must be type 'array'");if(this.strict=!!e,this.events={},this.Event=function(){this.ran=0,this.listeners=[]},t)for(let e of t)this.events[e]=new this.Event}on(t,e){if("function"!=typeof e)throw new TypeError(`Input 2 is type '${typeof e}' instead of 'function'`);if(!this.strict||this.events[t])return this.events[t]||(this.events[t]=new this.Event),this.events[t].listeners.push(e)-1;console.warn(`Event '${t}' does not exist`)}off(t,e){if(this.events[t]){if("function"==typeof e){let i=0;return this.events[t].listeners.forEach(((o,n)=>{o==e&&(i++,delete this.events[t].listeners[n])})),i}if("number"==typeof e){let i=this.events[t].listeners[e];return delete this.events[t].listeners[e],i}if(void 0===e)return this.events[t].listeners.splice(0,1/0);throw new TypeError(`Input 2 is type '${typeof a}' instead of 'function' or 'number'`)}this.strict&&console.warn(`Event '${t}' does not exist`)}emit(t,...e){return this.emitCall(t,this,...e)}emitCall(t,e,...i){if(!this.events[t]){if(this.strict)return console.warn(`Event '${t}' does not exist`),[];this.events[t]=new this.Event}let o=[];this.events[t].ran++;for(let n in this.events[t].listeners)try{o.push(this.events[t].listeners[n].apply(e,i))}catch(t){console.error(t),o.push(t)}return o}}let i=e.prototype;i.addEventListener=i.add=i.when=i.on,i.removeEventListener=i.remove=i.abort=i.off,i.dispatchEvent=i.dispatch=i.send=i.trigger=i.emit,i.dispatchEventContext=i.dispatchContext=i.sendContext=i.triggerContext=i.emitContext=i.dispatchEventCall=i.dispatchCall=i.sendCall=i.triggerCall=i.emitCall;class o extends e{constructor({parent:t,GM_info:e,scriptSource:i}){if(this.modInfo={},this.parent&&(this.parent=t),this.modInfo.scriptSource=i,e){if("object"!=typeof e)throw new TypeError("Invalid GM_info!");if(!e)throw new TypeError("Invalid GM_info!");this.modInfo.GM_info=e,this.modInfo.scriptSource||(this.modInfo.scriptSource=e.scriptSource),this.modInfo.name||(this.modInfo.name=this.modInfo.GM_info.script.name),this.modInfo.version||(this.modInfo.version=this.modInfo.GM_info.script.name)}if(!i)throw"No Script Source!";if(this.modInfo.header=o.parseScriptHeader(this.modInfo.scriptSource),this.modInfo.name=this.modInfo.header.name,!this.modInfo.name)throw"No module name!";this.modInfo.author=this.modInfo.header.author,this.modInfo.version=this.modInfo.header.version,this.modInfo.id=this.modInfo.header.UPI.id||o.camelize(this.modInfo.name),this.modInfo.abbrev=this.modInfo.header.UPI.abbrev||this.modInfo.name.split(" ").map((t=>t[0].toUpperCase())).join(""),this.modInfo.header.UPI.require&&(this.modInfo.require=this.modInfo.header.UPI.require.split(/\s*,\s*/)),this.parent?(this.parent[this.modInfo.id]=this,this.modInfo.idList=this.parent.abbrevList.concat([this.modInfo.id]),this.modInfo.abbrevList=this.parent.abbrevList.concat([this.modInfo.abbrev])):(this.modInfo.idList=[this.modInfo.id],this.modInfo.abbrevList=[this.modInfo.abbrev]),this.info(`${this.modInfo.name} by ${this.modinfo.author}`)}static camelize(t){return t.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,(function(t,e){return 0==+t?"":0===e?t.toLowerCase():t.toUpperCase()}))}static parseScriptHeader(t){let e=t.match(/(?:\/\/\s*)?==UserScript==([\S\s]*)==\/UserScript==/)[1].split(/\n\s*\/\//g).map((t=>t.trim())).filter((t=>t)).map((t=>{let e=t.match(/\s+/);return[t.slice(0,e.index).split("."),t.slice(e.index+e[0].length)]}));mod.debug("header arrayForm:",e);let i={};for(let[t,o]of e){let e=t.pop(),n=i;for(let e of t){if(e in n&&"object"!=typeof n[e])throw`Path ${t.join(".")} has existing value at ${e}`;n=n[e]}if(e in n)throw`Value ${t.join(".")}.${key} already exists`;n[e]=o}return mod.debug("header objForm:",i)}}["debug","log","info","warn","error"].forEach((t=>o.prototype[t]=function(...e){return console[t](`[${this.abbrevList.join(".")}]`,...e),e[0]})),UPI=new o({name:"United Program Interface",author:"SArpnt and TumbleGamer",id:"UPI",abbrev:"UPI"}),UPI.info(UPI)}();